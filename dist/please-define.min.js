/**
 * @name please-define.js
 * @version 1.1.3
 * @update Apr 11, 2017
 * @website https://github.com/earthchie/please-define.js
 * @author Earthchie http://www.earthchie.com/
 * @license WTFPL v.2 - http://www.wtfpl.net/
 **/
window.PleaseDefine=window.PleaseDefine||function(a,b){"use strict";b=b||{},b.placeholder=b.placeholder||"Other, please define.",b.required=b.required||""===a.getAttribute("required"),b.label_empty=b.label_empty||"- Please Choose -";var h,i,j,d=(a.value,a.getElementsByTagName("option")),e=document.createElement("div"),f="",g=b.label_empty,k=function(){if(void 0===document.createEvent)a.fireEvent("onchange");else{var b=document.createEvent("HTMLEvents");b.initEvent("change",!1,!0),a.dispatchEvent(b)}},l=function(a,b){b.parentNode.insertBefore(a,b.nextSibling)},n=function(a){for(var b=a.offsetTop,c=a.offsetLeft,d=a.offsetWidth,e=a.offsetHeight;a.offsetParent;)a=a.offsetParent,b+=a.offsetTop,c+=a.offsetLeft;return b>=window.pageYOffset&&c>=window.pageXOffset&&b+e<=window.pageYOffset+window.innerHeight&&c+d<=window.pageXOffset+window.innerWidth},o=function(a,b,c){var d=a.getAttribute("class").split(" ").filter(function(a){return""!==a});delete d[d.indexOf(b)],!0===c&&d.push(b),a.setAttribute("class",d.join(" "))},p=function(a,b){o(a,"active",b),o(a,"flip",!1),setTimeout(function(){o(a,"flip",!n(j))},1)},q=function(b){b.onclick=function(){a.value=this.getAttribute("data-value"),i.innerHTML=this.innerHTML,j.value="",p(e,!1),k()}};for(h=0;h<d.length;h+=1)""!==d[h].innerHTML&&(f+='<li data-value="'+d[h].value+'">'+d[h].innerHTML+"</li>");for(f+='<li><input type="text" placeholder="'+b.placeholder+'"></li>',e.setAttribute("class","please-define"),g=a.querySelector('[value="'+a.value+'"]'),g=null===g?b.label_empty:g.innerHTML,e.innerHTML="<span>"+g+"</span><ul>"+f+"</ul>",l(e,a),a.style.display="none",a.appendChild(document.createElement("option")),i=e.getElementsByTagName("span")[0],f=e.getElementsByTagName("li"),j=e.getElementsByTagName("input")[0],a.val=function(c){if("string"!=typeof c)return a.value;if(""!==c||!1===b.required){var d=a.getElementsByTagName("option"),e=a.querySelector('[value="'+c+'"]');e=!!e&&e.innerHTML,d[d.length-1].value=c,a.value=c,i.innerHTML=e||c||b.label_empty,k()}else a.value===a.querySelector("option:last-child").value&&(j.value=a.value)},window.onclick=function(){var a=document.querySelector(".please-define.active");null!==a&&p(a,!1)},e.onclick=function(a){a.stopPropagation();var b=document.querySelectorAll(".please-define.active");for(h=0;h<b.length;h+=1)b[h]!==e&&p(b[h],!1)},i.onclick=function(a){a.stopPropagation(),e.getAttribute("class").indexOf("active")>-1?p(e,!1):setTimeout(function(){p(e,!0)},1)},h=0;h<f.length-1;h+=1)q(f[h]);return j.onkeyup=function(c){var d=this.value;a.getElementsByTagName("option");return"function"==typeof b.filter&&(d=b.filter(d)||d),this.value=d,!1},j.onkeypress=function(b){if(13===(b.keyCode||b.which))return p(e,!1),a.val(this.value),!1},a};
